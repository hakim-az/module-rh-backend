generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                     String         @id
  role                   String
  statut                 String
  civilite               String?
  prenom                 String
  nomDeNaissance         String
  nomUsuel               String?
  situationFamiliale     String?
  numeroSecuriteSociale  String?
  emailPersonnel         String         @unique
  emailProfessionnel     String?        @unique
  telephonePersonnel     String
  telephoneProfessionnel String?
  avatar                 String         @map("avatar")
  createdAt              DateTime       @default(now())
  updatedAt              DateTime       @updatedAt
  absence                Absence[]
  adresse                Adresse?
  coffre                 Coffre[]
  contrat                Contrat?
  justificatif           Justificatif?
  naissance              Naissance?
  notification           Notification[]
  paiement               Paiement?
  restau                 Restau[]
  urgence                Urgence?
  userEmails             UserEmail[] 
  acces                  Acces[] 

  @@map("users")
}

model Naissance {
  id                     String   @id
  idUser                 String   @unique @map("id_user")
  dateDeNaissance        DateTime @map("date_de_naissance")
  paysDeNaissance        String
  departementDeNaissance String
  communeDeNaissance     String
  paysDeNationalite      String
  createdAt              DateTime @default(now())
  updatedAt              DateTime @updatedAt
  user                   User     @relation(fields: [idUser], references: [id], onDelete: Cascade)

  @@map("naissances")
}

model Adresse {
  id                     String   @id
  idUser                 String   @unique @map("id_user")
  pays                   String
  codePostal             String
  ville                  String
  adresse                String
  complementAdresse      String
  domiciliteHorsLaFrance String
  createdAt              DateTime @default(now())
  updatedAt              DateTime @updatedAt
  user                   User     @relation(fields: [idUser], references: [id], onDelete: Cascade)

  @@map("adresses")
}

model Paiement {
  id        String   @id
  idUser    String   @unique @map("id_user")
  iban      String
  bic       String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  user      User     @relation(fields: [idUser], references: [id], onDelete: Cascade)

  @@map("paiements")
}

model Urgence {
  id                String   @id
  idUser            String   @unique @map("id_user")
  nomComplet        String
  lienAvecLeSalarie String
  telephone         String
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  user              User     @relation(fields: [idUser], references: [id], onDelete: Cascade)

  @@map("urgences")
}

model Justificatif {
  id                             String   @id
  idUser                         String   @unique @map("id_user")
  fichierCarteVitalePdf          String   @map("fichier_carte_vitale_pdf")
  fichierRibPdf                  String   @map("fichier_rib_pdf")
  fichierPieceIdentitePdf        String   @map("fichier_piece_identite_pdf")
  fichierPieceIdentitePdfVerso   String   @map("fichier_piece_identite_pdf_verso")
  fichierJustificatifDomicilePdf String   @map("fichier_justificatif_domicile_pdf")
  autreFichier                   String   @map("autre_fichier")
  fichierAmeli                   String   @map("fichier_ameli")
  createdAt                      DateTime @default(now())
  updatedAt                      DateTime @updatedAt
  user                           User     @relation(fields: [idUser], references: [id], onDelete: Cascade)

  @@map("justificatifs")
}

model Contrat {
  id                         String   @id
  idUser                     String   @unique @map("id_user")
  poste                      String
  typeContrat                String
  dateDebut                  DateTime @map("date_debut")
  dateFin                    DateTime @map("date_fin")
  etablissementDeSante       String
  serviceDeSante             String
  matricule                  String
  salaire                    String
  fichierContratNonSignerPdf String?  @map("fichier_contrat_non_signer_pdf")
  fichierContratSignerPdf    String?  @map("fichier_contrat_signer_pdf")
  createdAt                  DateTime @default(now())
  updatedAt                  DateTime @updatedAt
  user                       User     @relation(fields: [idUser], references: [id], onDelete: Cascade)

  @@map("contrats")
}

model Absence {
  id                     String   @id
  idUser                 String   @map("id_user")
  typeAbsence            String
  dateDebut              DateTime @map("date_debut")
  dateFin                DateTime @map("date_fin")
  partieDeJour           String?
  note                   String?
  statut                 String?
  motifDeRefus           String?
  fichierJustificatifPdf String?  @map("fichier_justificatif_pdf")
  createdAt              DateTime @default(now())
  updatedAt              DateTime @updatedAt
  user      User     @relation(fields: [idUser], references: [id], onDelete: Cascade, map: "fk_absence_user")

  @@index([idUser], map: "absences_id_user_fkey")
  @@map("absences")
}

model Coffre {
  id                     String   @id
  idUser                 String   @map("id_user")
  typeBulletin           String
  mois                   String
  annee                  String
  note                   String?
  fichierJustificatifPdf String?  @map("fichier_justificatif_pdf")
  createdAt              DateTime @default(now())
  updatedAt              DateTime @updatedAt
  user      User     @relation(fields: [idUser], references: [id], onDelete: Cascade, map: "fk_coffre_user")

  @@index([idUser], map: "coffres_id_user_fkey")
  @@map("coffres")
}

model Restau {
  id                     String   @id
  idUser                 String   @map("id_user")
  nbrJours               String
  mois                   String
  annee                  String
  note                   String?
  fichierJustificatifPdf String?  @map("fichier_justificatif_pdf")
  createdAt              DateTime @default(now())
  updatedAt              DateTime @updatedAt
  user      User     @relation(fields: [idUser], references: [id], onDelete: Cascade, map: "fk_restau_user") 

  @@index([idUser], map: "restaux_id_user_fkey")
  @@map("restaux")
}

model Notification {
  id        String   @id @default(cuid())
  userId    String
  title     String
  message   String
  read      Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade, map: "fk_notification_user")

  @@index([userId], map: "notifications_userId_fkey")
  @@map("notifications")
}


model UserEmail {
  id           String   @id @default(uuid())
  userId       String   @unique
  upn          String   @unique 
  password     String   
  licenseSku   String?  
  isEnabled    Boolean  @default(true)
  isDeleted    Boolean  @default(false)
  deletedAt    DateTime?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  displayName  String  
  alias        String?

  // relations
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade, map: "mail_userId_user")

  @@index([userId], map: "mail_userId_fkey")
  @@map("user_emails")
}


model Acces {
  id           String   @id @default(uuid())
  userId       String   
  status       String
  productCode  String
  password     String?  
  email        String?

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  // relations
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade, map: "acces_userId_user")

  @@index([userId], map: "acces_userId_fkey")
  @@map("acces")
}